@{
    ViewData["Title"] = "E-posta Hesapları Yönetimi";
}

<div class="card mb-5">
    <div class="card-body">
        <div class="d-flex flex-wrap flex-stack">
            <div class="d-flex flex-column justify-content-center flex-wrap me-3">
                <h1 class="page-heading d-flex text-dark fw-bold fs-3 flex-column justify-content-center my-0">E-posta
                    Hesapları</h1>
                <ul class="breadcrumb breadcrumb-separatorless fw-semibold fs-7 my-0 pt-1">
                    <li class="breadcrumb-item text-muted"><a asp-area="Admin" asp-controller="Home" asp-action="Index"
                            class="text-muted text-hover-primary">Anasayfa</a></li>
                    <li class="breadcrumb-item"><span class="bullet bg-gray-400 w-5px h-2px"></span></li>
                    <li class="breadcrumb-item text-muted">Sistem Ayarları</li>
                    <li class="breadcrumb-item"><span class="bullet bg-gray-400 w-5px h-2px"></span></li>
                    <li class="breadcrumb-item text-dark">E-posta Hesapları</li>
                </ul>
            </div>
            <div class="d-flex align-items-center py-1">
                <a asp-area="Admin" asp-controller="EmailAccount" asp-action="Add" class="btn btn-primary">
                    <i class="ki-duotone ki-plus fs-2"></i> Yeni Hesap Ekle
                </a>
            </div>
        </div>
    </div>
</div>

<div class="card">
    <div class="card-header border-0 pt-6">
        <div class="card-title">
            <div class="d-flex align-items-center position-relative my-1">
                <i class="ki-duotone ki-magnifier fs-3 position-absolute ms-5"><span class="path1"></span><span
                        class="path2"></span></i>
                <input type="text" id="datatable_search_input" class="form-control form-control-solid w-250px ps-14"
                    placeholder="Hesaplarda Ara" />
            </div>
        </div>
    </div>
    <div class="card-body py-4">
        @Html.AntiForgeryToken()
        <table id="email_accounts_table" class="table table-row-dashed table-row-gray-300 align-middle gs-0 gy-4"
            data-get-url="@Url.Action("GetData", "EmailAccount", new { area = "Admin" })">
            <thead>
                <tr class="fw-bold text-muted">
                    <th class="min-w-250px">Görünen Ad</th>
                    <th class="min-w-200px">E-posta Adresi</th>
                    <th class="min-w-150px">Sunucu</th>
                    <th class="min-w-70px">Port</th>
                    <th class="min-w-150px">Kullanıcı Adı</th>
                    <th class="min-w-125px text-end">İşlemler</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>

@section Scripts {
    <script type="text/javascript">
        KTUtil.onDOMContentLoaded(function () {
            MetronicDataTables.init({
                table: '#email_accounts_table',
                search: {
                    input: '#datatable_search_input'
                },
                columns: [
                    { "data": "displayName", "name": "DisplayName" },
                    { "data": "email", "name": "Email" },
                    { "data": "host", "name": "Host" },
                    { "data": "port", "name": "Port" },
                    { "data": "username", "name": "Username" },
                    { "data": null, "name": "Actions", "orderable": false, "searchable": false }
                ],
                columnDefs: [
                    { targets: 3, render: function (data, type, row) { return `<span class="badge badge-light-info">${data}</span>`; } },
                    {
                        targets: -1, className: 'text-end',
                        render: function (data, type, row) {
                            return `
                                <a href="/Admin/EmailAccount/Edit/${row.id}" class="btn btn-icon btn-sm btn-light-primary me-1" title="Düzenle"><i class="ki-duotone ki-pencil fs-3"><span class="path1"></span><span class="path2"></span></i></a>
                                <a href="#" class="btn btn-icon btn-sm btn-light-danger" data-kt-delete-action="true" data-id="${row.id}" data-display-name="${row.displayName}" title="Sil"><i class="ki-duotone ki-trash fs-3"><span class="path1"></span><span class="path2"></span><span class="path3"></span><span class="path4"></span><span class="path5"></span></i></a>
                            `;
                        }
                    }
                ],
                action: {
                    selector: '[data-kt-delete-action="true"]',
                    url: '@Url.Action("Delete", "EmailAccount")',
                    confirmationText: "'{displayName}' hesabını silmek istediğinizden emin misiniz?",
                    confirmButtonText: "Evet, Sil!",
                    confirmButtonClass: "btn-danger"
                }
            });
        });
    </script>
}